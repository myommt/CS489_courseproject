<header th:fragment="header" xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <h2><i class="fas fa-tooth"></i> Dental Surgery</h2>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01"
                aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarColor01">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/">Home
                            <span class="visually-hidden">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/services">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/contact">Contact</a>
                    </li>
                    <!-- Authenticated users menu -->
                    <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                        <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button"
                            aria-haspopup="true" aria-expanded="false">Management</a>
                        <div class="dropdown-menu">
                            <!-- Admin can access all pages -->
                            <a class="dropdown-item" href="/secured/patient/list"
                                sec:authorize="hasRole('ADMIN')">Patients</a>
                            <a class="dropdown-item" href="/secured/dentist/list"
                                sec:authorize="hasRole('ADMIN')">Dentists</a>
                            <a class="dropdown-item" href="/secured/appointment/list"
                                sec:authorize="hasRole('ADMIN')">All Appointments</a>

                            <!-- Dentist can access their appointments -->
                            <a class="dropdown-item" href="/secured/appointment/my-appointments"
                                sec:authorize="hasRole('DENTIST')">My Appointments</a>

                            <!-- Patient can access dashboard, create appointments and check history -->
                            <a class="dropdown-item" th:href="@{/dentalsurgeryapp/rolebase/patient/dashboard}"
                                sec:authorize="hasRole('PATIENT')">Dashboard</a>
                            <a class="dropdown-item" th:href="@{/dentalsurgeryapp/rolebase/patient/appointments/new}"
                                sec:authorize="hasRole('PATIENT')">Book Appointment</a>
                            <a class="dropdown-item" th:href="@{/dentalsurgeryapp/rolebase/patient/appointments}"
                                sec:authorize="hasRole('PATIENT')">My History</a>

                            <div class="dropdown-divider" sec:authorize="hasRole('ADMIN')"></div>
                            <a class="dropdown-item" href="/secured/dashboard" sec:authorize="hasRole('SYSADMIN')">Admin
                                Dashboard</a>
                        </div>
                    </li>
                </ul>
                <div>
                    <!-- Show login button if not authenticated -->
                    <div sec:authorize="!isAuthenticated()">
                        <a class="btn btn-outline-light" href="/public/login">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </a>
                    </div>
                    <!-- Show user info and logout if authenticated -->
                    <div sec:authorize="isAuthenticated()">
                        <div class="dropdown">
                            <a class="btn btn-outline-light dropdown-toggle" href="#" role="button" id="userMenu"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user"></i> <span sec:authentication="name">User</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu">
                                <li><a class="dropdown-item" href="/secured/profile"><i class="fas fa-user-cog"></i>
                                        Profile</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li>
                                    <form th:action="@{/public/logout}" method="post" style="display: inline;">
                                        <button type="submit" class="dropdown-item">
                                            <i class="fas fa-sign-out-alt"></i> Logout
                                        </button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>